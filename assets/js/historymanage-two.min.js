function UrlReplace(){var e=document.URL,n=getUrlVars(e).ver,t=getUrlVars(e).matchVer,i="/v17.2.1/";if(null!=n&&"latest"!=n){var l=findNearestVersion(n);if("latest"!=l&&l!=n){var a=e.replace(n,l);a.indexOf("/docs/")>0&&(a=a.replace("/docs/","/docs-archive"+i),window.location.replace(a))}}null==t&&null!=n&&"latest"!=n&&e.indexOf("/docs/")>0&&(e=e.replace("/docs/","/docs-archive"+i),window.location.replace(e))}function allHerfClick(e,n){return addParam(e),!1}function GetVersionDiff(e,n){if("latest"==n)return 100;if(n<e)return-1;for(var t=e.split("."),i=n.split("."),l=0,a=Math.max(t.length,i.length),r=1,o=0;o<a;o++){var s=o<t.length?t[o]:0;if(isNaN(s)){l+=r;break}var d=o<i.length?i[o]:0;if(isNaN(d)){l+=r;break}var c=d-s;c>=0?(r/=10,l+=r*c):(l-=r,r/=10,l+=r*(c+10))}return l}function addParam(e,n=null,t=!1){if($(e).hasClass("fullUrl"))return void(window.location.href=e.href);var i=e.href,l=i;if(""==i)return;let a=i.indexOf("#"),r=i.indexOf("?"),o="";if(-1!=a)if(1!=r&&a<r){var s=i.split("?"),d=s[0].split("#");o="#"+d[1]}else{var c=i.split("#");o=2==c.length?"#"+c[1]:""}if("sidebar"==n){var f=document.URL.split("/docs/")[0]+"/docs/";if(e.href.indexOf(f)<0)return void(window.location.href=e.href);$(e).hasClass("activeLink")||RequestNewPage(e,l)}else if("docContainer"==n)"_blank"==e.target?window.open(l):findCurLinkOnFullTree(e,l);else if("rightMenuContainer"==n)if(o&&$(o.toLowerCase()).length>0){window.scrollTo(0,$(o.toLowerCase()).offset().top-160);var h=window.location.hash,u=document.URL;h?u=u.replace(h,o):u+="#"+o,$(e).hasClass("active")||history.pushState(null,null,u)}else window.location.href=i+o;else"_blank"==e.target?window.open(l):window.location.href=l}function RequestNewPage(e,n,t=!1){$("#articleContent").addClass("hidden"),$("#loadingContent").show(),fetch(e.href).then(function(e){return e.text()}).then(function(i){document.title=$(i)[1].innerText,!t&&history.pushState(null,null,n);for(var l=0;l<$("#fullTreeMenuListContainer .activeLink").parents("li").length;l++){var a=$("#fullTreeMenuListContainer .activeLink").parents("li")[l];$(a).hasClass("hasActiveLinkList")&&$(a).removeClass("hasActiveLinkList")}$("#fullTreeMenuListContainer .activeLink").removeClass("activeLink"),$(e).addClass("activeLink"),$(e).parents("li.collapseListStyle").length>0&&($(e).parents("li.collapseListStyle").addClass("expandListStyle").removeClass("collapseListStyle"),$(e).parents("li.expandListStyle").find(" > ul").slideDown()),$(e).parents("li.expandListStyle").addClass("hasActiveLinkList");var r=$("#articleContent").hasClass("showRightSideMenu");$("#articleContent").html($(i).find("#articleContent").html()).removeClass("hidden"),r||$("#articleContent").find(".rightSideMenu, .markdown-body").removeClass("showRightSideMenu"),$("#loadingContent").hide(),needh3=1==$(i).find("#articleContent").data("needh3");var o=document.getElementsByClassName("mainPage")[0];if(o.scrollHeight>o.clientHeight){var s=$(".activeLink").offset().top-$(".mainPage").offset().top;s-o.scrollTop+40>o.clientHeight&&(o.scrollTop=s-200)}if($(".headCounter").hasClass("noTitleIndex")?$("#AutoGenerateSidebar").addClass("noTitleIndex"):$("#AutoGenerateSidebar").removeClass("noTitleIndex"),$(i).find("#docHead").find(".iconsBox a").length>0){var d=$(i).find("#docHead").find(".iconsBox a")[0].href;$("#docHead .iconsBox a").attr("href",d)}var c=$("#articleContent").find("a");for(l=0;l<c.length;l++)c[l].onclick=function(){return addParam(this,"docContainer"),!1};$("#AutoGenerateSidebar").length>0&&($("#fullTreeMenuListContainer").removeClass("needh3"),needh3&&$("#fullTreeMenuListContainer").addClass("needh3"),GenerateContentByHead(needh3),0==$("#AutoGenerateSidebar > ul > li").length?$(".rightSideMenu > p").hide():$(".rightSideMenu > p").show()),$("#crumbs > ul").html($("#crumbs > ul > li").eq(0)),initCrumbs();var f=$(".markdown-body .highlight pre");for(l=0;l<f.length;l++){var h=document.createElement("i");h.className="copyIcon fa fa-copy",f[l].appendChild(h)}let u=$(".multi-panel-switching-prefix");for(let e=0;e<u.length;e++){let n=$(u[e]).find("+ul > li"),t=0;if(v&&""!=v)for(let e=0;e<n.length;e++)"#"+$(n[e]).find("a").attr("href")==v&&(t=e);$(n[t]).addClass("on");let i=$(u[e]).find("+ul ~");showSelectMultiPanel(i,t,needh3)}if($(".multi-panel-switching-prefix + ul > li").on("click",function(){$(this).parent("ul").find("li").removeClass("on"),$(this).addClass("on");let e=$(this).parent("ul").find("~");showSelectMultiPanel(e,$(this).index(),needh3)}),$(".markdown-body .sample-code-prefix").length>0&&getUrlVars(document.URL).lang){var p=getUrlVars(document.URL).lang.toLowerCase().trim().split(",");p&&(1==p.length?sampleCodeSingleLangInit(p[0]):sampleCodeLangsInit(p))}else if($(".markdown-body .sample-code-prefix").length>0){$(".markdown-body .sample-code-prefix + blockquote > ul > li:first-child").addClass("on"),$(".markdown-body .sample-code-prefix + blockquote > ol > li:first-child").addClass("on");var w=$(".markdown-body .sample-code-prefix.template2 + blockquote");for(l=0;l<w.length;l++)$(w[l]).find(">div").eq(0).addClass("on")}anchors.add();var v=n.split("#").length>1?n.split("#")[1].toLowerCase():null,g=$(window).scrollTop();if(v&&$("#"+v).length>0){var m=$("#"+v).offset().top;setTimeout(function(){window.scrollTo(0,m-160),realFunc()},100)}else if(g>0){m=g>$("#overall-header").height()?$("#overall-header").height():g;setTimeout(function(){window.scrollTo(0,m),realFunc()},100)}})}function findCurLinkOnFullTree(e,n,t=!1,i=!1){var l=$("#fullTreeMenuListContainer").find("a"),a=e.href.toLowerCase(),r=document.URL.toLowerCase();if(a=a.indexOf("?")>0?a.split("?")[0]:a.indexOf("#")>0?a.split("#")[0]:a,r=r.indexOf("?")>0?r.split("?")[0]:r.indexOf("#")>0?r.split("#")[0]:r,r==a&&(e.href.split("#").length>1||document.URL.split("#").length>1)&&!i){var o=e.href.split("#").length>1?e.href.split("#")[1].toLowerCase():null,s=$(e).parents("ul");(s.length<=0||!$(s[0]).prev().hasClass("multi-panel-switching-prefix"))&&o&&$("#"+o.toLowerCase()).length>0&&window.scrollTo(0,$("#"+o.toLowerCase()).offset().top-160),!t&&history.pushState(null,null,n)}else{for(var d=!1,c=0;c<l.length;c++){var f=l[c].href;f=f.indexOf("index.html")>0?f.replace("index.html",""):f,a=a.indexOf("index.html")>0?a.replace("index.html",""):a,f=f.indexOf("?")>0?f.split("?")[0]:f.indexOf("#")>0?f.split("#")[0]:f,f&&f.toLowerCase()==a.toLowerCase()&&(d=!0,RequestNewPage(l[c],n,t))}d||(window.location.href=n)}}function changeVersion(e){var n=e.innerText.toLowerCase(),t=null;t=n.indexOf("latest version")>=0?"latest":n.replace("version ","");var i=document.URL,l="/v"+t+"/";if(i.indexOf("web-twain/docs/")>0&&GetVersionDiff("17.2.1",t)<0&&(l="/v17.2.1/"),(i.indexOf("web-twain/docs/")>0||i.indexOf("remote-scan/docs/")>0)&&"latest"==t)window.location.href=i;else{i=i.replace("/docs/","/docs-archive"+l);var a=getUrlVars(i).src,r=void 0;-1!=i.indexOf("#")&&(r=i.split("#").pop()),-1!=i.indexOf("?")&&(i=i.substring(0,i.indexOf("?"))),-1!=i.indexOf("#")&&(i=i.substring(0,i.indexOf("#"))),i=i+"?ver="+t+"&&cVer=true",null!=a&&(i=i+"&&src="+a),null!=r&&(i=i+"#"+r),window.location.href=i}}function findNearestVersion(e){for(var n=$(".fullVersionInfo li"),t=e,i=null,l=0;l<n.length;l++){var a=$(n[l]).text().toLowerCase();if(a=a.indexOf("latest version")>=0?"latest":a.replace("version ",""),a==e)return a;var r=GetVersionDiff(e,a);(null==i||r>=0&&(r<i||i<0))&&(i=r,t=a)}return i?t:"latest"}function getCurrentUrlProductName(e=null){e=e?e.replace("https://",""):null,e=e?e.replace("http://",""):null;var n=e?e.replace(e.split("/")[0],""):document.location.pathname;n=n.slice(1,n.length);var t=n.split("/")[0];switch(t){case"web-twain":return"dwt";case"barcode-reader":return"dbr";case"label-recognition":return"dlr";case"camera-enhancer":return"dce";case"code-parser":return"dcp";case"document-normalizer":return"ddn";case"capture-vision":return"dcv";case"mobile-web-capture":return"mwc";default:return""}}window.addEventListener("popstate",function(e){findCurLinkOnFullTree({href:location.href},location.href,!0,!0)},!1);